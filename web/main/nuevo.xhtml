<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:o="http://omnifaces.org/ui"
      xmlns:of="http://omnifaces.org/functions">





    <ui:composition template="/template.xhtml">


        <f:metadata>
            <f:viewParam name="id" value="#{facturasBean.id}"/>
            <f:viewAction action="#{facturasBean.cargaDatos()}"/>
        </f:metadata>

        <p:idleMonitor timeout="1"></p:idleMonitor>

        <ui:define name="title">
            <h:outputText value="Inicio"></h:outputText>
        </ui:define>

        <ui:define name="body">

            <style type="text/css">
                .sideBar
                {

                    height: 100%;
                    background: rgba(254,254,254,1);
                    background: -moz-linear-gradient(left, rgba(254,254,254,1) 0%, rgba(219,219,219,0.9) 72%, rgba(209,209,209,0.86) 99%, rgba(226,226,226,0.86) 100%);
                    background: -webkit-gradient(left top, right top, color-stop(0%, rgba(254,254,254,1)), color-stop(72%, rgba(219,219,219,0.9)), color-stop(99%, rgba(209,209,209,0.86)), color-stop(100%, rgba(226,226,226,0.86)));
                    background: -webkit-linear-gradient(left, rgba(254,254,254,1) 0%, rgba(219,219,219,0.9) 72%, rgba(209,209,209,0.86) 99%, rgba(226,226,226,0.86) 100%);
                    background: -o-linear-gradient(left, rgba(254,254,254,1) 0%, rgba(219,219,219,0.9) 72%, rgba(209,209,209,0.86) 99%, rgba(226,226,226,0.86) 100%);
                    background: -ms-linear-gradient(left, rgba(254,254,254,1) 0%, rgba(219,219,219,0.9) 72%, rgba(209,209,209,0.86) 99%, rgba(226,226,226,0.86) 100%);
                    background: linear-gradient(to right, rgba(254,254,254,1) 0%, rgba(219,219,219,0.9) 72%, rgba(209,209,209,0.86) 99%, rgba(226,226,226,0.86) 100%);
                    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fefefe', endColorstr='#e2e2e2', GradientType=1 );
                    border-right: 1px solid #aaa;
                    overflow:hidden;
                    -webkit-box-shadow: -4px 0px 21px 0px rgba(50, 50, 50, 0.75);
                    -moz-box-shadow:    -4px 0px 21px 0px rgba(50, 50, 50, 0.75);
                    box-shadow:         -4px 0px 21px 0px rgba(50, 50, 50, 0.75);

                }




                .fila{
                    display: table-row;width: 100%;
                }


                .column10{
                    width: 10%;
                    text-align: left;
                }

                .column15{
                    width: 17%;
                    text-align: left;
                }
                .column20{
                    width: 20%;
                    text-align: left;
                }
                .column30{
                    width: 30%;
                    text-align: left;
                }
                .column40{
                    width: 40%;
                    text-align: left;
                }

                .column50{
                    width: 50%;
                    text-align: left;
                }
                .column60{
                    width: 60%;
                    text-align: left;
                }
                .column70{
                    width: 70%;
                    text-align: left;
                }
                .column80{
                    width: 80%;
                    text-align: left;
                }

                .column85{
                    width: 88%;
                    text-align: left;
                    padding-right: 10px;
                }

                .column90{
                    width: 90%;
                    text-align: left;
                    padding-right: 10px;
                }

                .column100{
                    width: 100%;
                    text-align: left;
                }




                div[id="formNuevo:growl_container"] {
                    position:absolute;
                    top:calc(40% - 180px);
                    left:calc(50% - 170px);
                }

            </style>



            <h:form id="formNuevo" style="height: 100%">
                <o:importConstants type="com.ideaspymes.contax.modelo.TipoImpuesto"/>
                <o:importConstants type="com.ideaspymes.contax.modelo.TipoFactura"/>
                <o:importConstants type="com.ideaspymes.contax.modelo.Clasificacion"/>


                <p:commandButton action="#{facturasBean.resfreca()}" value="Traer Imagen" style="position: absolute;top:calc( 1% - 10px);left:calc(7% - 20px);z-index: 3"
                                 ajax="false"/>
                <div class="ui-grid ui-grid-responsive" style="height: 100%">

                    <div class="ui-grid-row" style="height: 100%">
                        <div class="ui-grid-col-8">
                            <div class="ui-grid ui-grid-responsive" style="height: 100%">
                                <div class="ui-grid-row" style="height: 95%;">
                                    <div class="ui-grid-col-12" style="height: 100%;">


                                        <p:outputPanel id="imagen">



                                            <div id='content' style="z-index: 1">


                                                <div class='frame'>
                                                    <!--                                                    <o:graphicImage id="myImage" styleClass="myImage" value="{imagenController.obtNextImage(facturasBean.nombreArchivoSiguiente)}" />-->
                                                    <p:graphicImage value="#{imagenController.obtSiguienteImagen()}" id="myImage" styleClass="myImage">
                                                        <f:param name="nombreArchivo" value="#{facturasBean.nombreArchivoSiguiente}"/>
                                                    </p:graphicImage>
                                                </div>

                                                <div id='controls' style="background-color: white;padding-top: 10px;">
                                                    <a href='#' id='rotate_left'  title='Rotate left'><p:graphicImage library="img" name="rotate_left.png"/></a>
                                                    <a href='#' id='zoom_out'     title='Zoom out'><p:graphicImage library="img" name="zoom_out.png"/></a>
                                                    <a href='#' id='fit'          title='Fit image'><p:graphicImage library="img" name="fit.png"/></a>
                                                    <a href='#' id='zoom_in'      title='Zoom in'><p:graphicImage library="img" name="zoom_in.png"/></a>
                                                    <a href='#' id='rotate_right' title='Rotate right'><p:graphicImage library="img" name="rotate_right.png"/></a>
                                                </div>


                                            </div>
                                            <script type='text/javascript'>

                                                jQuery(function () {
                                                    var picture = jQuery('.myImage');


                                                    var camelize = function () {
                                                        var regex = /[\W_]+(.)/g
                                                        var replacer = function (match, submatch) {
                                                            return submatch.toUpperCase()
                                                        }
                                                        return function (str) {
                                                            return str.replace(regex, replacer)
                                                        }
                                                    }()

                                                    picture.guillotine({eventOnChange: 'guillotinechange'})
                                                    picture.guillotine('fit')
                                                    jQuery('#controls a').click(function (e) {
                                                        e.preventDefault()

                                                        action = camelize(this.id);

                                                        picture.guillotine(action);
                                                    })

                                                    //                                           
                                                })
                                            </script>
                                        </p:outputPanel>
                                    </div>
                                </div>

                            </div>




                        </div>

                        <div class="ui-grid-col-4" style="height: 100%">
                            <div class="sideBar">
                                <div style="padding: 20px;width: 100%">


                                    <p:growl autoUpdate="true" id="growl"/>

                                    <p:focus/>
                                    <div style="display: table;width: 100%">

                                        <div class="fila">

                                            <h:panelGrid columns="2" styleClass="column100" columnClasses="column15, column85">
                                                <h:outputText value="Cliente:" style="font-weight: bold"/>
                                                <p:outputPanel>
                                                    <p:inputText placeholder="RUC del Cliente" value="#{facturasBean.ruc}"
                                                                 style="width: 50%;margin-top: 5px;" rendered="true">

                                                        <p:ajax event="blur" update="cvCliente razonSocialCliente"
                                                                process="@this cvCliente razonSocialCliente" 
                                                                listener="#{facturasBean.buscarContribuyenteCliente()}"/>
                                                    </p:inputText>
                                                    <p:inputText placeholder="CV" value="#{facturasBean.cvCliente}"
                                                                 id="cvCliente" size="1"
                                                                 style="width: 5%;margin-top: 5px;" required="true"/>    
                                                </p:outputPanel>
                                                <p:spacer/>
                                                <p:inputText id="razonSocialCliente" 
                                                             style="margin-top: 5px;width: 90%"
                                                             placeholder="RAZON SOCIAL CLIENTE" value="#{facturasBean.actual.razonSocialCliente}"/>
                                            </h:panelGrid>


                                            <br/>
                                        </div>


                                        <div class="fila">

                                            <p:separator style="margin-top: 5px;margin-bottom: 10px;"/>

                                        </div>

                                        <div class="fila">

                                            <p:outputPanel id="tipoFacturaIRP">
                                                <h:panelGrid columns="2" styleClass="column100" columnClasses="column15,column85">
                                                    <h:outputText value="Tipo Impuesto: " style="font-weight: bold"/>
                                                    <p:outputPanel>
                                                        <p:selectOneMenu value="#{facturasBean.actual.tipoImpuesto}" style="margin-top: 5px;margin-bottom: 5px;">
                                                            <p:ajax event="change" process="@this" update="tipoFacturaIRP periodos tipos totales @(.numeroFact)" listener="#{facturasBean.siCambiaTipoImpuesto()}"/>
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{productorEnums.obtTiposImpuestos()}"
                                                                           var="e" itemLabel="#{e.value}" itemValue="#{e}"/>
                                                        </p:selectOneMenu>
                                                        <p:spacer width="20"/>
                                                        <p:selectBooleanCheckbox value="#{facturasBean.actual.cambiaPeriodo}" itemLabel="Mensual?"
                                                                                 rendered="#{(facturasBean.actual.tipoImpuesto == TipoImpuesto.IRPC)}">
                                                            <p:ajax process="@this" update="tipoFacturaIRP periodos tipos"/>
                                                        </p:selectBooleanCheckbox>
                                                    </p:outputPanel>


                                                    <h:outputText value="Libro:" style="font-weight: bold"
                                                                  rendered="#{(facturasBean.muestraTipoFactura or facturasBean.muestraSoloIvaSimplificado)}"
                                                                  styleClass="tipoFacturaIRP"/>

                                                    <h:panelGrid columns="3" styleClass="column100" columnClasses="column50,column20,column20" style="margin: 0; padding: 0;"
                                                                 rendered="#{(facturasBean.muestraTipoFactura or facturasBean.muestraSoloIvaSimplificado)}">
                                                        <p:selectOneMenu value="#{facturasBean.actual.tipoFactura}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                         rendered="#{facturasBean.muestraTipoFactura}" styleClass="tipoFacturaIRP">
                                                            <p:ajax event="change" process="@this" update="tipoFacturaIRP periodos tipos @(.proveedor) @(.numeroFact)"
                                                                    listener="#{facturasBean.siCambiaLibro()}"/>
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItem itemLabel="VENTAS" itemValue="VENTA"/>
                                                            <f:selectItem itemLabel="COMPRAS" itemValue="COMPRA"/>

                                                        </p:selectOneMenu>

                                                        <p:selectOneMenu value="#{facturasBean.actual.tipoFactura}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                         rendered="#{facturasBean.muestraSoloIvaSimplificado}" styleClass="tipoFacturaIRP">
                                                            <p:ajax event="change" process="@this" update="tipoFacturaIRP periodos tipos @(.proveedor) @(.numeroFact)"
                                                                    listener="#{facturasBean.siCambiaLibro()}"/>
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItem itemLabel="VENTAS" itemValue="VENTA"/>
                                                            <f:selectItem itemLabel="COMPRAS" itemValue="COMPRA"/>
                                                        </p:selectOneMenu>

                                                        <p:selectBooleanCheckbox value="#{facturasBean.actual.conIRP}" itemLabel="IRP?"
                                                                                 rendered="#{(facturasBean.muestraConIRP)}">
                                                            <p:ajax process="@this" update="tipoFacturaIRP periodos tipos @(.numeroFact)" listener="#{facturasBean.siCambiaConIRP()}"/>
                                                        </p:selectBooleanCheckbox>

                                                        <p:selectBooleanCheckbox value="#{facturasBean.actual.conIRPC}" itemLabel="IRPC?"
                                                                                 rendered="#{(facturasBean.muestraConIRPC)}">
                                                            <p:ajax process="@this" update="tipoFacturaIRP periodos tipos @(.numeroFact)" listener="#{facturasBean.siCambiaConIRPC()}"/>
                                                        </p:selectBooleanCheckbox>
                                                    </h:panelGrid>



                                                    <h:outputText value="Otros:" style="font-weight: bold" 
                                                                  rendered="#{((facturasBean.actual.tipoFactura == TipoFactura.VENTA or facturasBean.actual.tipoFactura == TipoFactura.COMPRA) and not(facturasBean.muestraSoloIvaSimplificado))}" 
                                                                  styleClass="tipoFacturaIRP"/>

                                                    <p:selectOneMenu value="#{facturasBean.actual.tipoAjustes}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                     rendered="#{((facturasBean.actual.tipoFactura == TipoFactura.VENTA or facturasBean.actual.tipoFactura == TipoFactura.COMPRA) and not(facturasBean.muestraSoloIvaSimplificado))}" 
                                                                     styleClass="tipoFacturaIRP">
                                                        <p:ajax event="change" process="@this " update=" tipoFacturaIRP tipos @(.proveedor)"/>
                                                        <f:selectItem itemLabel="--" itemValue=""/>
                                                        <f:selectItem itemLabel="AJUSTES/DEVOLUCIONES/DESCUENTOS" itemValue="AJUSTES/DEVOLUCIONES/DESCUENTOS"/>
                                                        <f:selectItem itemLabel="EXPORTACIONES/IMPORTACIONES" itemValue="EXPORTACIONES/IMPORTACIONES"/>
                                                    </p:selectOneMenu>



                                                    <h:outputText value="Tipo Exportación:" style="font-weight: bold" rendered="#{facturasBean.actual.tipoAjustes == 'EXPORTACIONES/IMPORTACIONES'}" styleClass="tipoFacturaIRP"/>

                                                    <p:selectOneMenu value="#{facturasBean.actual.tipoExportacion}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                     rendered="#{facturasBean.actual.tipoAjustes == 'EXPORTACIONES/IMPORTACIONES'}" styleClass="tipoFacturaIRP">
                                                        <p:ajax event="change" process="@this " update=" tipoFacturaIRP tipos @(.proveedor)"/>
                                                        <f:selectItem itemLabel="--" itemValue=""/>
                                                        <f:selectItem itemLabel="AGROPECUARIAS" itemValue="AGROPECUARIAS"/>
                                                        <f:selectItem itemLabel="OTROS" itemValue="OTROS"/>

                                                        <!--                                                        <f:selectItems value="{productorEnums.obtClasificacionesIRP()}"/>-->
                                                    </p:selectOneMenu>


                                                    <h:outputText value="Clasificación IRP:" style="font-weight: bold" rendered="#{(facturasBean.muestraClasificacionIRP or facturasBean.muestraClasificacionSoloIRPC)}" styleClass="tipoFacturaIRP"/>

                                                    <p:selectOneMenu value="#{facturasBean.actual.clasificacion}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                     rendered="#{(facturasBean.muestraClasificacionIRP and (facturasBean.actual.tipoFactura == null) and not facturasBean.muestraClasificacionSoloIRPC)}" styleClass="tipoFacturaIRP">
                                                        <p:ajax event="change" process="@this " update=" tipoFacturaIRP tipos @(.proveedor)"
                                                                listener="#{facturasBean.siCambiaClasificionIRP()}"/>
                                                        <f:selectItem itemLabel="--" itemValue=""/>
                                                        <f:selectItem itemLabel="INGRESOS" itemValue="INGRESOS"/>
                                                        <f:selectItem itemLabel="GASTOS" itemValue="GASTOS"/>
                                                        <f:selectItem itemLabel="INVERSION" itemValue="INVERSION"/>
                                                        <!--                                                        <f:selectItems value="{productorEnums.obtClasificacionesIRP()}"/>-->
                                                    </p:selectOneMenu>


                                                    <p:selectOneMenu value="#{facturasBean.actual.clasificacion}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                     rendered="#{facturasBean.muestraClasificacionSoloIRPC}" styleClass="tipoFacturaIRP">
                                                        <p:ajax event="change" process="@this " update=" tipoFacturaIRP tipos @(.proveedor)"
                                                                listener="#{facturasBean.siCambiaClasificionIRP()}"/>
                                                        <f:selectItem itemLabel="--" itemValue=""/>
                                                        <f:selectItem itemLabel="INGRESOS" itemValue="INGRESOS"/>
                                                        <f:selectItem itemLabel="GASTOS" itemValue="GASTOS"/>
                                                        <!--                                                        <f:selectItems value="{productorEnums.obtClasificacionesIRP()}"/>-->
                                                    </p:selectOneMenu>

                                                    <p:selectOneMenu value="#{facturasBean.actual.clasificacion}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                     rendered="#{(facturasBean.muestraClasificacionIRP and (facturasBean.actual.tipoFactura == TipoFactura.VENTA ))}" styleClass="tipoFacturaIRP">
                                                        <p:ajax event="change" process="@this " update="tipoFacturaIRP tipos"
                                                                listener="#{facturasBean.siCambiaClasificionIRP()}"/>
                                                        <f:selectItem itemLabel="--" itemValue=""/>
                                                        <f:selectItem itemLabel="INGRESOS" itemValue="INGRESOS"/>

                                                        <!--                                                        <f:selectItems value="{productorEnums.obtClasificacionesIRP()}"/>-->
                                                    </p:selectOneMenu>

                                                    <p:selectOneMenu value="#{facturasBean.actual.clasificacion}" style="margin-top: 5px;width: 80%;margin-bottom: 5px;"
                                                                     rendered="#{(facturasBean.muestraClasificacionIRP and (facturasBean.actual.tipoFactura == TipoFactura.COMPRA ))}" styleClass="tipoFacturaIRP">
                                                        <p:ajax event="change" process="@this " update=" tipoFacturaIRP tipos"
                                                                listener="#{facturasBean.siCambiaClasificionIRP()}"/>
                                                        <f:selectItem itemLabel="--" itemValue=""/>
                                                        <f:selectItem itemLabel="GASTOS" itemValue="GASTOS"/>
                                                        <f:selectItem itemLabel="INVERSION" itemValue="INVERSION"/>
                                                        <!--                                                        <f:selectItems value="{productorEnums.obtClasificacionesIRP()}"/>-->
                                                    </p:selectOneMenu>
                                                </h:panelGrid>

                                            </p:outputPanel>




                                        </div>



                                        <div class="fila">
                                            <p:outputPanel id="tipos">

                                                <h:panelGrid columns="2" styleClass="column100" columnClasses="column15,column85">
                                                    <h:outputText value="Tipo Ingreso:" style="font-weight: bold"
                                                                  rendered="#{facturasBean.muestraIngresos}"/>
                                                    <p:outputPanel rendered="#{facturasBean.muestraIngresos}">
                                                        <p:selectOneMenu value="#{facturasBean.tipoIngresoSeleccionado}" style="margin-top: 5px;margin-bottom: 5px;"
                                                                         rendered="#{facturasBean.muestraIngresos}">
                                                            <p:ajax process="@this" event="change" update="subTipoIngreso tipos totales @(.numeroFact)"
                                                                    listener="#{facturasBean.siCambiaTipoIngreso()}"/>
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{facturasBean.itemsAvailableTipoIngreso}"/>
                                                        </p:selectOneMenu>

                                                        <p:selectOneMenu 
                                                            rendered="#{facturasBean.muestraIngresos}"
                                                            id="subTipoIngreso"
                                                            value="#{facturasBean.subTipoIngresoSeleccionado}" style="margin-top: 5px;margin-bottom: 5px;">
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{facturasBean.itemsSubTipoIngreso}"/>
                                                        </p:selectOneMenu>


                                                        <p:selectBooleanCheckbox value="#{facturasBean.generarAporteIPS}" itemLabel="Generar Aporte IPS?" style="margin-left: 10px"
                                                                                 rendered="#{(facturasBean.muestraGenerarAporteIPS)}">

                                                        </p:selectBooleanCheckbox>
                                                    </p:outputPanel>

                                                    <h:outputText value="Tipo Gastos:" style="font-weight: bold"
                                                                  rendered="#{facturasBean.muestraGastos}"/>

                                                    <p:outputPanel rendered="#{facturasBean.muestraGastos}">
                                                        <p:selectOneMenu value="#{facturasBean.tipoGastoSeleccionado}" style="margin-top: 5px;margin-bottom: 5px;"
                                                                         rendered="#{facturasBean.muestraGastos}">
                                                            <p:ajax process="@this" event="change" update="subTipoGasto tipos @(.numeroFact)"
                                                                    listener="#{facturasBean.siCambiaTipoGasto()}"/>
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{tipoGastoController.itemsAvailableSelectOne}"/>
                                                        </p:selectOneMenu>
                                                        <p:selectOneMenu 
                                                            rendered="#{facturasBean.muestraGastos}"
                                                            id="subTipoGasto"
                                                            value="#{facturasBean.subTipoGastoSeleccionado}" style="margin-top: 5px;margin-bottom: 5px;">
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{facturasBean.itemsSubTipoGasto}"/>
                                                        </p:selectOneMenu>
                                                    </p:outputPanel>

                                                    <h:outputText value="Tipo Inversión:" style="font-weight: bold"
                                                                  rendered="#{facturasBean.muestraInversion}"/>

                                                    <p:outputPanel rendered="#{facturasBean.muestraInversion}">
                                                        <p:selectOneMenu value="#{facturasBean.tipoInversionSeleccionado}" style="margin-top: 5px;margin-bottom: 5px;"
                                                                         rendered="#{facturasBean.muestraInversion}">
                                                            <p:ajax process="@this" event="change" update="subTipoInversion tipos @(.numeroFact)"
                                                                    listener="#{facturasBean.siCambiaTipoInversion()}"/>
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{tipoInversionController.itemsAvailableSelectOne}"/>
                                                        </p:selectOneMenu>
                                                        <p:selectOneMenu 
                                                            rendered="#{facturasBean.muestraInversion}"
                                                            id="subTipoInversion"
                                                            value="#{facturasBean.subTipoInversionSeleccionado}" style="margin-top: 5px;margin-bottom: 5px;">
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItems value="#{facturasBean.itemsSubTipoInversion}"/>
                                                        </p:selectOneMenu>
                                                    </p:outputPanel>
                                                </h:panelGrid>

                                            </p:outputPanel>
                                        </div>





                                        <div class="fila">

                                            <p:separator style="margin-top: 5px;margin-bottom: 10px;"/>

                                        </div>

                                        <div class="fila">

                                        </div>
                                        <div class="fila">


                                            <h:panelGrid columns="2" styleClass="column100" columnClasses="column15, column85">


                                                <h:outputText value="Fecha:" style="font-weight: bold"/>

                                                <p:calendar value="#{facturasBean.actual.fecha}" locale="es" pattern="dd/MM/yyyy">
                                                    <p:ajax process="@this" update="periodos" event="blur"/>
                                                </p:calendar>

                                                <h:outputText value="Periodo a declarar:" style="font-weight: bold;"/>


                                                <p:outputPanel id="periodos" style="text-align: left;margin: 0px;padding: 0px;"> 

                                                    <h:panelGrid columns="3">




                                                        <p:selectOneMenu value="#{facturasBean.actual.periodoMes}" style="width: 75px;margin-left: 15px;"
                                                                         rendered="#{(facturasBean.actual.tipoImpuesto == TipoImpuesto.IVA_GENERAL)}">
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItem itemLabel="Ene" itemValue="Ene"/>
                                                            <f:selectItem itemLabel="Feb" itemValue="Feb"/>
                                                            <f:selectItem itemLabel="Mar" itemValue="Mar"/>
                                                            <f:selectItem itemLabel="Abr" itemValue="Abr"/>
                                                            <f:selectItem itemLabel="May" itemValue="May"/>
                                                            <f:selectItem itemLabel="Jun" itemValue="Jun"/>
                                                            <f:selectItem itemLabel="Jul" itemValue="Jul"/>
                                                            <f:selectItem itemLabel="Ago" itemValue="Ago"/>
                                                            <f:selectItem itemLabel="Sep" itemValue="Sep"/>
                                                            <f:selectItem itemLabel="Oct" itemValue="Oct"/>
                                                            <f:selectItem itemLabel="Nov" itemValue="Nov"/>
                                                            <f:selectItem itemLabel="Dic" itemValue="Dic"/>
                                                        </p:selectOneMenu>


                                                        <p:selectOneMenu value="#{facturasBean.actual.periodoMes}" style="width: 75px;margin-left: 15px;"
                                                                         rendered="#{(facturasBean.actual.tipoImpuesto == TipoImpuesto.IRPC and facturasBean.actual.cambiaPeriodo)}">
                                                            <f:selectItem itemLabel="--" itemValue=""/>
                                                            <f:selectItem itemLabel="Ene" itemValue="Ene"/>
                                                            <f:selectItem itemLabel="Feb" itemValue="Feb"/>
                                                            <f:selectItem itemLabel="Mar" itemValue="Mar"/>
                                                            <f:selectItem itemLabel="Abr" itemValue="Abr"/>
                                                            <f:selectItem itemLabel="May" itemValue="May"/>
                                                            <f:selectItem itemLabel="Jun" itemValue="Jun"/>
                                                            <f:selectItem itemLabel="Jul" itemValue="Jul"/>
                                                            <f:selectItem itemLabel="Ago" itemValue="Ago"/>
                                                            <f:selectItem itemLabel="Sep" itemValue="Sep"/>
                                                            <f:selectItem itemLabel="Oct" itemValue="Oct"/>
                                                            <f:selectItem itemLabel="Nov" itemValue="Nov"/>
                                                            <f:selectItem itemLabel="Dic" itemValue="Dic"/>
                                                        </p:selectOneMenu>


                                                        <p:selectOneMenu styleClass="campos" value="#{facturasBean.actual.periodoMes}" style="width: 110px;margin-left: 15px;" rendered="#{(facturasBean.actual.tipoImpuesto == TipoImpuesto.IVA_SIMPLIFICADO)}">
                                                            <f:selectItem itemLabel="1er Cuatri" itemValue="1er Cuatri"/>
                                                            <f:selectItem itemLabel="2do Cuatri" itemValue="2do Cuatri"/>
                                                            <f:selectItem itemLabel="3er Cuatri" itemValue="3er Cuatri"/>
                                                        </p:selectOneMenu>

                                                        <p:selectOneMenu styleClass="campos" value="#{facturasBean.actual.periodoMes}" style="width: 110px;margin-left: 15px;" rendered="#{(facturasBean.actual.tipoImpuesto == TipoImpuesto.IRPC and not(facturasBean.actual.cambiaPeriodo))}">
                                                            <f:selectItem itemLabel="1er Cuatri" itemValue="1er Cuatri"/>
                                                            <f:selectItem itemLabel="2do Cuatri" itemValue="2do Cuatri"/>
                                                            <f:selectItem itemLabel="3er Cuatri" itemValue="3er Cuatri"/>
                                                        </p:selectOneMenu>

                                                        <p:inputText value="#{facturasBean.actual.periodoAnio}" placeholder="Año" id="periodoAnio" size="4"/>


                                                    </h:panelGrid>



                                                </p:outputPanel>


                                                <p:outputPanel styleClass="numeroFact">
                                                    <h:outputText value="Nro Factura:" style="font-weight: bold;margin-bottom: 5px" rendered="#{not facturasBean.muestraGenerarAporteIPS}"/>
                                                </p:outputPanel>




                                                <p:outputPanel styleClass="numeroFact">


                                                    <h:panelGrid columns="5" rendered="#{not facturasBean.muestraGenerarAporteIPS}">
                                                        <p:inputText value="#{facturasBean.codEst}" size="3" style="font-size: 12pt; font-weight: bold; max-width: 30px;text-align: right" maxlength="3" 
                                                                     binding="#{codEstablecimiento}"
                                                                     id="codEstablecimiento"/>
                                                        <h:outputText value=" - " style="font-size: 12pt; font-weight: bold;"/>
                                                        <p:inputText value="#{facturasBean.codSuc}" size="3" style="font-size: 12pt; font-weight: bold;max-width: 30px;text-align: right" maxlength="3" 
                                                                     binding="#{puntoExpedicion}"
                                                                     id="puntoExpedicion"/>
                                                        <h:outputText value=" - " style="font-size: 12pt; font-weight: bold;"/>
                                                        <p:inputText value="#{facturasBean.numeroFact}" size="7" style="font-size: 12pt; font-weight: bold;text-align: right" maxlength="7"
                                                                     id="numero">

                                                            <p:ajax event="blur" update="codEstablecimiento,puntoExpedicion,numero" process="codEstablecimiento,puntoExpedicion,numero"/>
                                                        </p:inputText>
                                                    </h:panelGrid>
                                                </p:outputPanel>
                                                <p:spacer></p:spacer>

                                                <!--                                                <p:inputText style="margin-bottom: 10px;width: 50%;"
                                                                                                             value="{facturasBean.actual.numero}" rendered="{not facturasBean.muestraGenerarAporteIPS}"/>-->


                                                <p:outputPanel styleClass="proveedor">
                                                    <h:outputText value="Proveedor:" style="font-weight: bold"
                                                                  rendered="#{(facturasBean.actual.clasificacion == Clasificacion.GASTOS or facturasBean.actual.clasificacion == Clasificacion.INVERSION or facturasBean.actual.tipoFactura == TipoFactura.COMPRA)}"/>
                                                </p:outputPanel>



                                                <p:outputPanel styleClass="proveedor">
                                                    <p:inputText placeholder="RUC del Proveedor" value="#{facturasBean.rucProveedor}"
                                                                 style="width: 50%;margin-top: 5px;"
                                                                 rendered="#{(facturasBean.actual.clasificacion == Clasificacion.GASTOS or facturasBean.actual.clasificacion == Clasificacion.INVERSION or facturasBean.actual.tipoFactura == TipoFactura.COMPRA)}">
                                                        <p:ajax event="blur" update="cvProveedor razonSocialProveedor"
                                                                process="@this cvProveedor razonSocialProveedor" 
                                                                listener="#{facturasBean.buscarContribuyenteProveedor()}"/>
                                                    </p:inputText>
                                                    <p:inputText placeholder="CV" value="#{facturasBean.cvProveedor}"
                                                                 id="cvProveedor" size="1"
                                                                 style="width: 5%;margin-top: 5px;"
                                                                 rendered="#{(facturasBean.actual.clasificacion == Clasificacion.GASTOS or facturasBean.actual.clasificacion == Clasificacion.INVERSION or facturasBean.actual.tipoFactura == TipoFactura.COMPRA)}"/>
                                                </p:outputPanel>

                                                <p:outputPanel styleClass="proveedor">
                                                    <p:spacer/>
                                                </p:outputPanel>
                                                <p:outputPanel styleClass="proveedor">
                                                    <p:inputText id="razonSocialProveedor"
                                                                 style="margin-top: 5px;width: 90%"
                                                                 placeholder="RAZON SOCIAL PROVEEDOR" value="#{facturasBean.actual.razonSocialProveedor}"
                                                                 rendered="#{(facturasBean.actual.clasificacion == Clasificacion.GASTOS or facturasBean.actual.clasificacion == Clasificacion.INVERSION or facturasBean.actual.tipoFactura == TipoFactura.COMPRA)}"/>
                                                </p:outputPanel>

                                            </h:panelGrid>


                                        </div>

                                        <div class="fila">

                                            <p:separator style="margin-top: 5px;margin-bottom: 10px;"/>

                                        </div>


                                        <p:outputPanel id="totales">
                                            <h:panelGrid columns="2" styleClass="column100" columnClasses="column15,column85">

                                                <p:spacer/>
                                                <p:outputPanel rendered="#{(facturasBean.actual.tipoImpuesto != TipoImpuesto.IVA_SIMPLIFICADO and not(facturasBean.muestraGenerarAporteIPS))}" style="margin-right: 20px">

                                                    <h:panelGrid columns="3" style="padding-right: 10px">
                                                        <h:outputText value="Exento:" style="font-weight: bold;margin-top: 10px"/>
                                                        <h:outputText value="Gravada 5%:" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>
                                                        <h:outputText value="Gravada 10%:" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>

                                                        <p:inputText style="margin-top: 5px;width: 90%;font-size: 12pt!important;font-weight: bold;text-align: right"
                                                                     value="#{facturasBean.actual.exento}">
                                                            <p:ajax event="blur" process="@this" update="@(.calculos)"/>
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>
                                                        <p:inputText style="margin-top: 5px;width: 90%;margin-left: 10px;font-size: 12pt!important;font-weight: bold;text-align: right"
                                                                     value="#{facturasBean.actual.gravada05}">
                                                            <p:ajax event="blur" process="@this" update="@(.calculos)"/>
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>

                                                        <p:inputText style="margin-top: 5px;width: 90%;margin-left: 10px;font-size: 12pt!important;font-weight: bold;text-align: right"
                                                                     value="#{facturasBean.actual.gravada10}">
                                                            <p:ajax event="blur" process="@this" update="@(.calculos)"/>
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>


                                                        <h:outputText value="IVA 5%:" style="font-weight: bold;margin-top: 10px"/>
                                                        <h:outputText value="IVA 10%:" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>
                                                        <h:outputText value="TOTAL IVA:" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>

                                                        <p:inputText style="margin-top: 5px;width: 90%;font-size: 12pt!important;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.iva05}">
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>
                                                        <p:inputText style="margin-top: 5px;width: 90%;font-size: 12pt!important;margin-left: 10px;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.iva10}"> 
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>
                                                        <p:inputText style="margin-top: 5px;width: 90%;font-size: 12pt!important;margin-left: 10px;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.totalIva}">
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>

                                                        <p:spacer/>
                                                        <h:outputText value="Gravada 5% Neto:" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>
                                                        <h:outputText value="Gravada 10% Neto:" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>

                                                        <p:spacer/>
                                                        <p:inputText style="margin-top: 5px;width: 90%;font-size: 12pt!important;margin-left: 10px;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.gravada05Neto}"> 
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>
                                                        <p:inputText style="margin-top: 5px;width: 90%;font-size: 12pt!important;margin-left: 10px;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.gravada10Neto}">
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>

                                                        <p:spacer/>
                                                        <h:outputText value="Total (Neto):" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>
                                                        <h:outputText value="Total (Bruto):" style="font-weight: bold;margin-top: 10px;margin-left: 10px"/>

                                                        <p:spacer/>
                                                        <p:inputText style="margin-top: 5px;width: 90%;margin-left: 10px;font-size: 12pt!important;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.totalNeto}"> 
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>
                                                        <p:inputText style="margin-top: 5px;width: 90%;margin-left: 10px;font-size: 12pt!important;font-weight: bold;text-align: right" styleClass="calculos"
                                                                     value="#{facturasBean.actual.totalBruto}">
                                                            <f:convertNumber locale="#{formato.locale}"/>
                                                        </p:inputText>

                                                    </h:panelGrid>
                                                </p:outputPanel>

                                            </h:panelGrid>

                                            <p:outputPanel rendered="#{(facturasBean.actual.tipoImpuesto == TipoImpuesto.IVA_SIMPLIFICADO or (facturasBean.muestraGenerarAporteIPS))}">

                                                <h:panelGrid columns="2" styleClass="column100" columnClasses="column15, column85">


                                                    <h:outputText value="Total (Bruto):" style="font-weight: bold;"/>
                                                    <p:inputText styleClass="calculos" style="font-size: 12pt!important;font-weight: bold;text-align: right"
                                                                 value="#{facturasBean.actual.totalBruto}">
                                                        <f:convertNumber locale="#{formato.locale}"/>
                                                    </p:inputText>

                                                </h:panelGrid>
                                            </p:outputPanel>
                                        </p:outputPanel>

                                    </div>
                                    <br/>
                                    <br/>
                                    <div style="display: table;width: 100%">
                                        <div style="display: table-cell;width: 50%;text-align: left;vertical-align: middle">
                                            <p:commandButton value="Guardar" action="#{facturasBean.guardar()}" ajax="false"/>
                                        </div>
                                        <div style="display: table-cell;width: 25%;text-align: right;vertical-align: middle">
                                            <p:button value="Listado" outcome="/main/listado" style="float: right; margin-right: 50px;"/>
                                        </div>
                                        <div style="display: table-cell;width: 25%;text-align: right;vertical-align: middle">
                                            <p:commandButton value="Cancelar" action="/main/home" ajax="false" style="float: right; margin-right: 50px;" immediate="true"/>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </h:form>


        </ui:define>
    </ui:composition>

</html>
